- [ ] Active Directory
- [ ] OpenSCAP
- [ ] Metter i servizi in Alta Affidabilità 
	- [ ] Proporne un architettura
- [ ] POC  Su ambienti MASE
- [ ] Verifica Update proxy mgrpxy


Opzione 1 — PAM Authentication (più comune per AD)

  Uyuni supporta autenticazione via PAM (Pluggable Authentication Modules). Configurando SSSD sul server Uyuni, puoi collegarlo
   ad Azure AD o AD on-premises.

  Flusso:
  User login → Uyuni Web UI → PAM → SSSD → Azure AD / AD DS

  Sul server Uyuni (SLES/openSUSE):
  # Installa SSSD e realm
  zypper install sssd realmd

  # Unisci il server al dominio AD (on-premises o Azure AD DS)
  realm join --user=admin@domain.example.com domain.example.com

  # Verifica
  realm list
  id user@domain.example.com

  In Uyuni Web UI:
  - Admin → Users → crea utente con PAM authentication abilitata
  - Spunta "Authenticate via PAM" nel profilo utente

  ---
  Opzione 2 — Azure AD Domain Services (LDAP)

  Azure AD nativo non espone LDAP. Devi abilitare Azure AD Domain Services (AADDS), che fornisce:
  - LDAP tradizionale compatibile con AD
  - Kerberos / NTLM

  Azure AD → Azure AD Domain Services → LDAP → SSSD → Uyuni PAM

  Limitazione: AADDS ha un costo aggiuntivo in Azure.

  ---
  Opzione 3 — SAML / SSO (Uyuni 2023+)

  Uyuni supporta SAML 2.0 per SSO, compatibile con Azure AD come Identity Provider.

  In Azure:
  1. Entra ID → Enterprise Applications → New Application → Non-gallery
  2. Configura SAML con:
    - Identifier (Entity ID): https://<uyuni-server>/saml/metadata
    - Reply URL: https://<uyuni-server>/saml/acs
  3. Scarica il Federation Metadata XML

  In Uyuni (/etc/rhn/rhn.conf):
  java.saml_idp_metadata = /etc/uyuni/saml/azure-metadata.xml
  java.saml_enabled = true

  Poi riavvia il servizio:
  systemctl restart tomcat

  ---
  Confronto opzioni

  ┌─────────────────────────┬─────────────┬────────────────────┬───────────────────────────┐
  │         Opzione         │ Complessità │    Costo Azure     │     Raccomandato per      │
  ├─────────────────────────┼─────────────┼────────────────────┼───────────────────────────┤
  │ PAM + SSSD + AADDS      │ Media       │ AADDS = ~150€/mese │ Ambienti ibridi con AD DS │
  ├─────────────────────────┼─────────────┼────────────────────┼───────────────────────────┤
  │ PAM + SSSD + AD on-prem │ Bassa       │ Nessuno            │ AD on-premises esistente  │
  ├─────────────────────────┼─────────────┼────────────────────┼───────────────────────────┤
  │ SAML SSO con Azure AD   │ Media       │ Nessuno            │ Solo Azure AD (Entra ID)  │
  └─────────────────────────┴─────────────┴────────────────────┴───────────────────────────┘

  ---
  Considerazione per il tuo ambiente

  Guardando la tua architettura (Uyuni su 10.172.2.17, VM Azure), la via più pratica senza costi aggiuntivi è:

  4. SAML con Entra ID — se gestisci già identità su Azure AD
  5. PAM + SSSD + AD on-prem — se hai un domain controller raggiungibile dalla VNET