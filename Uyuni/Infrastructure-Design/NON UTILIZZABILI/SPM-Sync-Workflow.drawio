<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.8 Chrome/140.0.7339.240 Electron/38.4.0 Safari/537.36" version="28.2.8">
  <diagram name="SPM Sync Workflow - Data Flow" id="sync-workflow">
    <mxGraphModel dx="2037" dy="1201" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1800" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="&lt;b&gt;Security Data Synchronization Flow&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=20;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="452.5" y="10" width="600" height="30" as="geometry" />
        </mxCell>
        <mxCell id="phase1-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#f5f5f5;strokeWidth=2;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="30" y="80" width="400" height="410" as="geometry" />
        </mxCell>
        <mxCell id="phase1-title" value="&lt;b&gt;PHASE 1: External Data Sources&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=14;fontColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="110" y="90" width="250" height="25" as="geometry" />
        </mxCell>
        <mxCell id="usn-box" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="125" width="170" height="160" as="geometry" />
        </mxCell>
        <mxCell id="usn-title" value="&lt;b&gt;Ubuntu Security Notices&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="60" y="130" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="usn-url" value="&lt;font style=&quot;font-size:8px&quot;&gt;ubuntu.com/security/notices.json&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="55" y="145" width="160" height="15" as="geometry" />
        </mxCell>
        <mxCell id="usn-data" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;Data extracted:&lt;/b&gt;&lt;br&gt;â€¢ USN-XXXX-X (advisory_id)&lt;br&gt;â€¢ Title, Description&lt;br&gt;â€¢ Priority â†’ Severity&lt;br&gt;â€¢ CVE list (cves[])&lt;br&gt;â€¢ release_packages{}&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="60" y="170" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="dsa-box" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="240" y="125" width="170" height="160" as="geometry" />
        </mxCell>
        <mxCell id="dsa-title" value="&lt;b&gt;Debian Security Tracker&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="250" y="130" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="dsa-url" value="&lt;font style=&quot;font-size:8px&quot;&gt;security-tracker.debian.org/json&lt;br&gt;(~63MB single download)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="245" y="145" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="dsa-data" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;Data structure:&lt;/b&gt;&lt;br&gt;â€¢ package_name â†’ CVE dict&lt;br&gt;â€¢ releases{bookworm, bullseye}&lt;br&gt;â€¢ status: resolved/open&lt;br&gt;â€¢ fixed_version&lt;br&gt;â€¢ urgency â†’ severity&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="250" y="170" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="nvd-box" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="300" width="170" height="165" as="geometry" />
        </mxCell>
        <mxCell id="nvd-title" value="&lt;b&gt;NVD API 2.0 (NIST)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="60" y="305" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="nvd-url" value="&lt;font style=&quot;font-size:8px&quot;&gt;services.nvd.nist.gov/rest/json/cves/2.0&lt;br&gt;Rate: 0.6s (API key) / 6s (no key)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="60" y="323" width="160" height="25" as="geometry" />
        </mxCell>
        <mxCell id="nvd-data" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;CVE enrichment:&lt;/b&gt;&lt;br&gt;â€¢ CVSS v3.1/v3.0 score&lt;br&gt;â€¢ CVSS vector string&lt;br&gt;â€¢ CWE IDs&lt;br&gt;â€¢ Description (EN)&lt;br&gt;â€¢ Published/Modified dates&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="60" y="350" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="oval-box" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="240" y="300" width="170" height="165" as="geometry" />
        </mxCell>
        <mxCell id="oval-title" value="&lt;b&gt;OVAL Definitions&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="250" y="305" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="oval-urls" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;Ubuntu:&lt;/b&gt; security-metadata.canonical.com&lt;br&gt;&lt;b&gt;Debian:&lt;/b&gt; debian.org/security/oval&lt;br&gt;(bz2 compressed XML)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="245" y="323" width="160" height="35" as="geometry" />
        </mxCell>
        <mxCell id="oval-data" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;XML structure:&lt;/b&gt;&lt;br&gt;â€¢ oval_id (definition ID)&lt;br&gt;â€¢ title, description&lt;br&gt;â€¢ severity (advisory)&lt;br&gt;â€¢ CVE references[]&lt;br&gt;â€¢ platform/version&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="250" y="358" width="150" height="92" as="geometry" />
        </mxCell>
        <mxCell id="phase2-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#f5f5f5;strokeWidth=2;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="520" y="80" width="450" height="410" as="geometry" />
        </mxCell>
        <mxCell id="phase2-title" value="&lt;b&gt;&lt;font style=&quot;color: rgb(0, 0, 0);&quot;&gt;PHASE 2: Flask API Processing&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=14;fontColor=#0066CC;" parent="1" vertex="1">
          <mxGeometry x="620" y="90" width="250" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-flow" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="540" y="125" width="200" height="130" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-title" value="&lt;b&gt;&lt;font style=&quot;color: rgb(0, 0, 0);&quot;&gt;sync_usn() [FIX #4]&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=10;fontColor=#0066CC;" parent="1" vertex="1">
          <mxGeometry x="570" y="130" width="140" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-step1" value="&lt;font style=&quot;font-size:8px&quot;&gt;1. Query last advisory_id&lt;br&gt;(temporal index)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="550" y="152.5" width="90" height="47.5" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-step2" value="&lt;font style=&quot;font-size:8px&quot;&gt;2. Fetch JSON&lt;br&gt;limit=20, offset++&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="645" y="153" width="85" height="47" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-step3" value="&lt;font style=&quot;font-size:8px&quot;&gt;3. Stop if found last_usn&lt;br&gt;or date older&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="550" y="208" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-step4" value="&lt;font style=&quot;font-size:8px&quot;&gt;4. Insert errata +&lt;br&gt;packages + CVEs&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="645" y="208" width="85" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sync-usn-delay" value="&lt;font style=&quot;font-size:7px;color:#666666&quot;&gt;0.5s delay between requests&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="570" y="235" width="140" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-flow" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="750" y="125" width="200" height="130" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-title" value="&lt;b&gt;&lt;font style=&quot;color: rgb(0, 0, 0);&quot;&gt;sync_dsa_full() [FIX #5]&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=10;fontColor=#0066CC;" parent="1" vertex="1">
          <mxGeometry x="780" y="130" width="150" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-step1" value="&lt;font style=&quot;font-size:8px&quot;&gt;1. Download full JSON&lt;br&gt;(~63MB, 300s timeout)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="760" y="155" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-step2" value="&lt;font style=&quot;font-size:8px&quot;&gt;2. Filter releases:&lt;br&gt;bookworm, bullseye&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="858" y="155" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-step3" value="&lt;font style=&quot;font-size:8px&quot;&gt;3. Batch processing&lt;br&gt;(500 packages/batch)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="760" y="208" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-step4" value="&lt;font style=&quot;font-size:8px&quot;&gt;4. Create DEB-CVE-&lt;br&gt;release advisory_id&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="858" y="208" width="85" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sync-dsa-note" value="&lt;font style=&quot;font-size:7px;color:#666666&quot;&gt;Only status=&#39;resolved&#39; with fixed_version&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="765" y="235" width="170" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sync-nvd-flow" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="540" y="265" width="200" height="105" as="geometry" />
        </mxCell>
        <mxCell id="sync-nvd-title" value="&lt;b&gt;&lt;font style=&quot;color: rgb(0, 0, 0);&quot;&gt;sync_nvd() - CVE Enrichment&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=10;fontColor=#0066CC;" parent="1" vertex="1">
          <mxGeometry x="560" y="270" width="160" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sync-nvd-step1" value="&lt;font style=&quot;font-size:8px&quot;&gt;1. Get pending CVEs&lt;br&gt;(prioritize high sev)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="550" y="290" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sync-nvd-step2" value="&lt;font style=&quot;font-size:8px&quot;&gt;2. Fetch NVD API&lt;br&gt;per CVE ID&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="640" y="290" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sync-nvd-step3" value="&lt;font style=&quot;font-size:8px&quot;&gt;3. Insert cve_details (CVSS, CWE, description)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="550" y="330" width="175" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sync-oval-flow" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="750" y="265" width="200" height="105" as="geometry" />
        </mxCell>
        <mxCell id="sync-oval-title" value="&lt;b&gt;&lt;font style=&quot;color: rgb(0, 0, 0);&quot;&gt;sync_oval() [FIX #2]&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=10;fontColor=#0066CC;" parent="1" vertex="1">
          <mxGeometry x="790" y="270" width="120" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sync-oval-step1" value="&lt;font style=&quot;font-size:8px&quot;&gt;1. Download bz2&lt;br&gt;decompress XML&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="760" y="290" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sync-oval-step2" value="&lt;font style=&quot;font-size:8px&quot;&gt;2. Parse definitions&lt;br&gt;(ElementTree)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="850" y="290" width="85" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sync-oval-step3" value="&lt;font style=&quot;font-size:8px&quot;&gt;3. Insert oval_definitions + errata_cve_oval_map&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="760" y="330" width="175" height="25" as="geometry" />
        </mxCell>
        <mxCell id="common-box" value="" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="540" y="385" width="410" height="85" as="geometry" />
        </mxCell>
        <mxCell id="common-title" value="&lt;b&gt;Common Processing Steps&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="660" y="390" width="160" height="15" as="geometry" />
        </mxCell>
        <mxCell id="common-step1" value="&lt;font style=&quot;font-size:8px&quot;&gt;INSERT sync_logs&lt;br&gt;(sync_type, &#39;running&#39;)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="550" y="410" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="common-step2" value="&lt;font style=&quot;font-size:8px&quot;&gt;@retry_with_backoff&lt;br&gt;(max=3, delay*2)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="650" y="410" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="common-step3" value="&lt;font style=&quot;font-size:8px&quot;&gt;ON CONFLICT&lt;br&gt;DO NOTHING/UPDATE&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="750" y="410" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="common-step4" value="&lt;font style=&quot;font-size:8px&quot;&gt;UPDATE sync_logs&lt;br&gt;(&#39;completed&#39;)&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="850" y="410" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="common-arrow1" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="640" y="427" as="sourcePoint" />
            <mxPoint x="650" y="427" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="common-arrow2" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="740" y="427" as="sourcePoint" />
            <mxPoint x="750" y="427" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="common-arrow3" value="" style="endArrow=classic;html=1;rounded=0;strokeColor=#000000;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="840" y="427" as="sourcePoint" />
            <mxPoint x="850" y="427" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="phase3-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#f5f5f5;strokeWidth=2;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="1065" y="85" width="380" height="505" as="geometry" />
        </mxCell>
        <mxCell id="phase3-title" value="&lt;b&gt;&lt;font style=&quot;color: rgb(0, 0, 0);&quot;&gt;PHASE 3: PostgreSQL Storage&lt;/font&gt;&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=14;fontColor=#6C8EBF;" parent="1" vertex="1">
          <mxGeometry x="1155" y="95" width="220" height="25" as="geometry" />
        </mxCell>
        <mxCell id="db-errata" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#6C8EBF;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1085" y="130" width="170" height="160" as="geometry" />
        </mxCell>
        <mxCell id="db-errata-title" value="&lt;b&gt;errata&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#E6F2FF;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1085" y="130" width="170" height="20" as="geometry" />
        </mxCell>
        <mxCell id="db-errata-cols" value="&lt;font style=&quot;font-size:8px&quot;&gt;id (PK SERIAL)&lt;br&gt;advisory_id (UNIQUE)&lt;br&gt;title VARCHAR(500)&lt;br&gt;description TEXT&lt;br&gt;severity VARCHAR(20)&lt;br&gt;source (&#39;usn&#39;|&#39;dsa&#39;)&lt;br&gt;distribution VARCHAR(50)&lt;br&gt;issued_date TIMESTAMP&lt;br&gt;sync_status (&#39;pending&#39;|&#39;synced&#39;)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1090" y="153" width="160" height="105" as="geometry" />
        </mxCell>
        <mxCell id="db-cves" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#6C8EBF;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1265" y="130" width="160" height="75" as="geometry" />
        </mxCell>
        <mxCell id="db-cves-title" value="&lt;b&gt;cves&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#E6F2FF;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1265" y="130" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="db-cves-cols" value="&lt;font style=&quot;font-size:8px&quot;&gt;id (PK SERIAL)&lt;br&gt;cve_id VARCHAR(20) UNIQUE&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1270" y="153" width="150" height="50" as="geometry" />
        </mxCell>
        <mxCell id="db-cve-details" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#6C8EBF;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1265" y="215" width="160" height="145" as="geometry" />
        </mxCell>
        <mxCell id="db-cve-details-title" value="&lt;b&gt;cve_details&lt;/b&gt; (NVD)" style="text;html=1;strokeColor=none;fillColor=#FFE6CC;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1265" y="215" width="160" height="20" as="geometry" />
        </mxCell>
        <mxCell id="db-cve-details-cols" value="&lt;font style=&quot;font-size:8px&quot;&gt;cve_id VARCHAR(20) PK&lt;br&gt;cvss_v3_score DECIMAL&lt;br&gt;cvss_v3_vector VARCHAR&lt;br&gt;cvss_v3_severity VARCHAR&lt;br&gt;cvss_v2_score DECIMAL&lt;br&gt;severity VARCHAR(20)&lt;br&gt;cwe_ids TEXT[]&lt;br&gt;nvd_last_sync TIMESTAMP&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1270" y="238" width="150" height="95" as="geometry" />
        </mxCell>
        <mxCell id="db-errata-pkg" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#6C8EBF;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1085" y="300" width="170" height="98.5" as="geometry" />
        </mxCell>
        <mxCell id="db-errata-pkg-title" value="&lt;b&gt;errata_packages&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#E6F2FF;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1085" y="300" width="170" height="20" as="geometry" />
        </mxCell>
        <mxCell id="db-errata-pkg-cols" value="&lt;font style=&quot;font-size:8px&quot;&gt;id (PK SERIAL)&lt;br&gt;errata_id FK â†’ errata.id&lt;br&gt;package_name VARCHAR&lt;br&gt;fixed_version VARCHAR&lt;br&gt;release_name VARCHAR&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1085" y="312.5" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="db-oval" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#6C8EBF;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1085" y="410" width="170" height="145" as="geometry" />
        </mxCell>
        <mxCell id="db-oval-title" value="&lt;b&gt;oval_definitions&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#D5E8D4;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1085" y="410" width="170" height="20" as="geometry" />
        </mxCell>
        <mxCell id="db-oval-cols" value="&lt;font style=&quot;font-size:8px&quot;&gt;oval_id VARCHAR PK&lt;br&gt;title VARCHAR(500)&lt;br&gt;description TEXT&lt;br&gt;severity VARCHAR(20)&lt;br&gt;platform VARCHAR(50)&lt;br&gt;platform_version VARCHAR&lt;br&gt;cve_refs TEXT[]&lt;br&gt;source_url VARCHAR&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1090" y="425" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="db-cache" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#6C8EBF;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="1265" y="370" width="160" height="132.5" as="geometry" />
        </mxCell>
        <mxCell id="db-cache-title" value="&lt;b&gt;uyuni_package_cache&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=#F8CECC;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1265" y="370" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="db-cache-cols" value="&lt;font style=&quot;font-size:8px&quot;&gt;channel_label VARCHAR&lt;br&gt;package_id INT&lt;br&gt;package_name VARCHAR&lt;br&gt;package_version VARCHAR&lt;br&gt;package_release VARCHAR&lt;br&gt;package_arch VARCHAR&lt;br&gt;last_sync TIMESTAMP&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1270" y="390.5" width="150" height="85" as="geometry" />
        </mxCell>
        <mxCell id="join-errata-cves" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;errata_cves&lt;/b&gt;&lt;br&gt;errata_id FK&lt;br&gt;cve_id FK&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#9673A6;fillColor=#E1D5E7;" parent="1" vertex="1">
          <mxGeometry x="1470" y="370" width="60" height="45" as="geometry" />
        </mxCell>
        <mxCell id="db-sync-logs" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;sync_logs&lt;/b&gt;&lt;br&gt;sync_type, status,&lt;br&gt;started_at, completed_at,&lt;br&gt;items_processed, error_message&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#82B366;fillColor=#D5E8D4;" parent="1" vertex="1">
          <mxGeometry x="1470" y="440" width="160" height="65" as="geometry" />
        </mxCell>
        <mxCell id="arr-usn-label" value="&lt;font style=&quot;font-size:8px&quot;&gt;HTTP GET&lt;br&gt;JSON&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="445" y="245" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="arr-api-db-label" value="&lt;font style=&quot;font-size:8px&quot;&gt;psycopg2&lt;br&gt;INSERT/UPDATE&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="982.5" y="257.5" width="70" height="25" as="geometry" />
        </mxCell>
        <mxCell id="schedule-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#F5F5F5;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="112.5" y="630" width="1280" height="180" as="geometry" />
        </mxCell>
        <mxCell id="schedule-title" value="&lt;b&gt;Scheduling Timeline (Azure Logic Apps)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="612.5" y="640" width="300" height="25" as="geometry" />
        </mxCell>
        <mxCell id="time-00" value="&lt;b&gt;00:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="132.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="time-03" value="&lt;b&gt;03:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="287.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="time-04" value="&lt;b&gt;04:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="339.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="time-06" value="&lt;b&gt;06:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="442.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="time-12" value="&lt;b&gt;12:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="752.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="time-18" value="&lt;b&gt;18:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1062.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="time-24" value="&lt;b&gt;24:00&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=9;" parent="1" vertex="1">
          <mxGeometry x="1342.5" y="725" width="40" height="15" as="geometry" />
        </mxCell>
        <mxCell id="sched-dsa" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;DSA&lt;/b&gt;&lt;br&gt;30m&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;" parent="1" vertex="1">
          <mxGeometry x="287.5" y="680" width="40" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sched-nvd" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;NVD&lt;/b&gt;&lt;br&gt;30m&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;" parent="1" vertex="1">
          <mxGeometry x="339.5" y="680" width="40" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sched-usn1" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;USN&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;" parent="1" vertex="1">
          <mxGeometry x="442.5" y="690" width="35" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sched-usn2" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;USN&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;" parent="1" vertex="1">
          <mxGeometry x="752.5" y="690" width="35" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sched-usn3" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;USN&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;" parent="1" vertex="1">
          <mxGeometry x="1062.5" y="690" width="35" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sched-usn4" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;USN&lt;/b&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;" parent="1" vertex="1">
          <mxGeometry x="132.5" y="690" width="35" height="25" as="geometry" />
        </mxCell>
        <mxCell id="sched-oval" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;OVAL&lt;/b&gt;&lt;br&gt;Weekly Sun 02:00&lt;br&gt;(60m timeout)&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#6C8EBF;dashed=1;" parent="1" vertex="1">
          <mxGeometry x="217.5" y="650" width="65" height="65" as="geometry" />
        </mxCell>
        <mxCell id="cron-push1" value="&lt;font style=&quot;font-size:7px&quot;&gt;push&lt;br&gt;00:30&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;" parent="1" vertex="1">
          <mxGeometry x="167.5" y="745" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cron-push2" value="&lt;font style=&quot;font-size:7px&quot;&gt;push&lt;br&gt;06:30&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;" parent="1" vertex="1">
          <mxGeometry x="477.5" y="745" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cron-push3" value="&lt;font style=&quot;font-size:7px&quot;&gt;push&lt;br&gt;12:30&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;" parent="1" vertex="1">
          <mxGeometry x="787.5" y="745" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cron-push4" value="&lt;font style=&quot;font-size:7px&quot;&gt;push&lt;br&gt;18:30&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;" parent="1" vertex="1">
          <mxGeometry x="1097.5" y="745" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cron-sync-ch" value="&lt;font style=&quot;font-size:7px&quot;&gt;sync-ch&lt;br&gt;01:00&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;" parent="1" vertex="1">
          <mxGeometry x="204.5" y="745" width="35" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sched-legend" value="&lt;font style=&quot;font-size:8px&quot;&gt;&lt;b&gt;Legend:&lt;/b&gt; ðŸŸ© USN sync | ðŸŸ¨ DSA/NVD sync | ðŸŸ¦ OVAL weekly | ðŸŸ¥ UYUNI push (cron) | ðŸŸª Channel sync (cron)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="472.5" y="785" width="550" height="15" as="geometry" />
        </mxCell>
        <mxCell id="JWdLHGhbRUdKhUbbyoQe-1" value="" style="endArrow=classic;html=1;rounded=0;exitX=1.001;exitY=0.487;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="phase1-bg">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="450" y="330" as="sourcePoint" />
            <mxPoint x="520" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="JWdLHGhbRUdKhUbbyoQe-2" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.001;entryY=0.403;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" target="phase3-bg">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="970" y="289" as="sourcePoint" />
            <mxPoint x="1050" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="timeline-line" value="" style="endArrow=classic;html=1;rounded=0;strokeWidth=3;strokeColor=#333333;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="132.5" y="720" as="sourcePoint" />
            <mxPoint x="1372.5" y="720" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
