<mxfile host="draw.io" agent="Claude Code" version="28.2.8">
  <diagram name="SPM Database Schema - Entity Relationship" id="db-schema">
    <mxGraphModel dx="1800" dy="1200" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="&lt;b&gt;SPM Database Schema - PostgreSQL Entity Relationship Diagram&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=20;fontColor=#333333;" parent="1" vertex="1">
          <mxGeometry x="450" y="20" width="600" height="30" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="&lt;font style=&quot;font-size:12px&quot;&gt;Database: pg-errata-test.postgres.database.azure.com | Schema: uyuni_errata&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="500" y="50" width="500" height="20" as="geometry" />
        </mxCell>

        <!-- ERRATA TABLE - Main Entity -->
        <mxCell id="tbl-errata" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#0066CC;fillColor=#DAE8FC;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="40" y="100" width="280" height="280" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-header" value="&lt;b&gt;errata&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;116,261 records&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#0066CC;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="40" y="100" width="280" height="35" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”‘ id&lt;/b&gt;              SERIAL PRIMARY KEY&lt;br&gt;&lt;b&gt;   advisory_id&lt;/b&gt;     VARCHAR(50) UNIQUE NOT NULL&lt;br&gt;   title            VARCHAR(500)&lt;br&gt;   description      TEXT&lt;br&gt;   severity         VARCHAR(20)&lt;br&gt;   source           VARCHAR(10) -- 'usn'|'dsa'&lt;br&gt;   distribution     VARCHAR(50)&lt;br&gt;   issued_date      TIMESTAMP&lt;br&gt;   sync_status      VARCHAR(20) DEFAULT 'pending'&lt;br&gt;   created_at       TIMESTAMP DEFAULT NOW()&lt;br&gt;   updated_at       TIMESTAMP&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="45" y="140" width="270" height="180" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-idx" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;Indexes:&lt;/b&gt;&lt;br&gt;â€¢ idx_errata_advisory_id (advisory_id)&lt;br&gt;â€¢ idx_errata_sync_status (sync_status)&lt;br&gt;â€¢ idx_errata_distribution (distribution)&lt;br&gt;â€¢ idx_errata_issued_date (issued_date DESC)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#E6F2FF;align=left;verticalAlign=top;rounded=0;spacingLeft=5;spacingTop=3;" parent="1" vertex="1">
          <mxGeometry x="45" y="315" width="270" height="60" as="geometry" />
        </mxCell>

        <!-- CVES TABLE -->
        <mxCell id="tbl-cves" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#82B366;fillColor=#D5E8D4;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="580" y="100" width="220" height="130" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cves-header" value="&lt;b&gt;cves&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;47,845 records&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#82B366;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="580" y="100" width="220" height="35" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cves-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”‘ id&lt;/b&gt;        SERIAL PRIMARY KEY&lt;br&gt;&lt;b&gt;   cve_id&lt;/b&gt;    VARCHAR(20) UNIQUE&lt;br&gt;             -- 'CVE-YYYY-NNNNN'&lt;br&gt;   created_at TIMESTAMP&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="585" y="140" width="210" height="85" as="geometry" />
        </mxCell>

        <!-- CVE_DETAILS TABLE (NVD) -->
        <mxCell id="tbl-cve-details" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#D79B00;fillColor=#FFE6CC;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="580" y="260" width="280" height="260" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cve-details-header" value="&lt;b&gt;cve_details&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;NVD Enrichment Data&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#D79B00;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="580" y="260" width="280" height="35" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cve-details-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”‘ cve_id&lt;/b&gt;         VARCHAR(20) PRIMARY KEY&lt;br&gt;                   FK â†’ cves.cve_id&lt;br&gt;   cvss_v3_score    DECIMAL(3,1)&lt;br&gt;   cvss_v3_vector   VARCHAR(100)&lt;br&gt;   cvss_v3_severity VARCHAR(20)&lt;br&gt;   cvss_v2_score    DECIMAL(3,1)&lt;br&gt;   cvss_v2_vector   VARCHAR(100)&lt;br&gt;   severity         VARCHAR(20)&lt;br&gt;   description      TEXT&lt;br&gt;   published_date   TIMESTAMP&lt;br&gt;   last_modified    TIMESTAMP&lt;br&gt;   cwe_ids          TEXT[] -- Array&lt;br&gt;   nvd_last_sync    TIMESTAMP&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="585" y="300" width="270" height="215" as="geometry" />
        </mxCell>

        <!-- ERRATA_CVES JOIN TABLE -->
        <mxCell id="tbl-errata-cves" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#9673A6;fillColor=#E1D5E7;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="360" y="130" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-cves-header" value="&lt;b&gt;errata_cves&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Join Table (M:N)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#9673A6;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="360" y="130" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-cves-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”— errata_id&lt;/b&gt;  INT FK â†’ errata.id&lt;br&gt;&lt;b&gt;ðŸ”— cve_id&lt;/b&gt;     INT FK â†’ cves.id&lt;br&gt;&lt;br&gt;UNIQUE(errata_id, cve_id)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="365" y="165" width="170" height="80" as="geometry" />
        </mxCell>

        <!-- ERRATA_PACKAGES TABLE -->
        <mxCell id="tbl-errata-pkg" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#0066CC;fillColor=#DAE8FC;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="40" y="410" width="280" height="200" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-pkg-header" value="&lt;b&gt;errata_packages&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Package-Errata Association&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#0066CC;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="40" y="410" width="280" height="35" as="geometry" />
        </mxCell>
        <mxCell id="tbl-errata-pkg-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”‘ id&lt;/b&gt;            SERIAL PRIMARY KEY&lt;br&gt;&lt;b&gt;ðŸ”— errata_id&lt;/b&gt;     INT FK â†’ errata.id&lt;br&gt;   package_name   VARCHAR(200)&lt;br&gt;   fixed_version  VARCHAR(100)&lt;br&gt;   release_name   VARCHAR(50)&lt;br&gt;   created_at     TIMESTAMP&lt;br&gt;&lt;br&gt;UNIQUE(errata_id, package_name, release_name)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="45" y="450" width="270" height="155" as="geometry" />
        </mxCell>

        <!-- OVAL_DEFINITIONS TABLE -->
        <mxCell id="tbl-oval" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#82B366;fillColor=#D5E8D4;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="900" y="100" width="280" height="250" as="geometry" />
        </mxCell>
        <mxCell id="tbl-oval-header" value="&lt;b&gt;oval_definitions&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;50,862 records (Ubuntu 5,359 + Debian 45,503)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#82B366;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="900" y="100" width="280" height="35" as="geometry" />
        </mxCell>
        <mxCell id="tbl-oval-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”‘ oval_id&lt;/b&gt;        VARCHAR(100) PRIMARY KEY&lt;br&gt;   title           VARCHAR(500)&lt;br&gt;   description     TEXT&lt;br&gt;   severity        VARCHAR(20)&lt;br&gt;   platform        VARCHAR(50)&lt;br&gt;   platform_version VARCHAR(20)&lt;br&gt;   cve_refs        TEXT[] -- Array of CVE IDs&lt;br&gt;   source_url      VARCHAR(500)&lt;br&gt;   last_sync       TIMESTAMP&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="905" y="140" width="270" height="165" as="geometry" />
        </mxCell>
        <mxCell id="tbl-oval-idx" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;Indexes:&lt;/b&gt;&lt;br&gt;â€¢ idx_oval_platform (platform)&lt;br&gt;â€¢ idx_oval_cve_refs (cve_refs) GIN&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#E8F5E9;align=left;verticalAlign=top;rounded=0;spacingLeft=5;spacingTop=3;" parent="1" vertex="1">
          <mxGeometry x="905" y="300" width="270" height="45" as="geometry" />
        </mxCell>

        <!-- UYUNI_PACKAGE_CACHE TABLE -->
        <mxCell id="tbl-cache" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#B85450;fillColor=#F8CECC;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="900" y="380" width="280" height="230" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cache-header" value="&lt;b&gt;uyuni_package_cache&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;140,937 records - From UYUNI channels&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#B85450;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="900" y="380" width="280" height="35" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cache-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;   channel_label    VARCHAR(200)&lt;br&gt;   package_id       INT -- from UYUNI&lt;br&gt;   package_name     VARCHAR(200)&lt;br&gt;   package_version  VARCHAR(100)&lt;br&gt;   package_release  VARCHAR(100)&lt;br&gt;   package_arch     VARCHAR(20)&lt;br&gt;   last_sync        TIMESTAMP&lt;br&gt;&lt;br&gt;PRIMARY KEY (channel_label, package_id)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="905" y="420" width="270" height="145" as="geometry" />
        </mxCell>
        <mxCell id="tbl-cache-idx" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;Indexes:&lt;/b&gt;&lt;br&gt;â€¢ idx_cache_channel_pkg (channel_label, package_name)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#FFEBEE;align=left;verticalAlign=top;rounded=0;spacingLeft=5;spacingTop=3;" parent="1" vertex="1">
          <mxGeometry x="905" y="565" width="270" height="40" as="geometry" />
        </mxCell>

        <!-- SYNC_LOGS TABLE -->
        <mxCell id="tbl-sync-logs" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#F5F5F5;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="360" y="280" width="180" height="180" as="geometry" />
        </mxCell>
        <mxCell id="tbl-sync-logs-header" value="&lt;b&gt;sync_logs&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;Audit Trail&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#666666;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="360" y="280" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tbl-sync-logs-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”‘ id&lt;/b&gt;             SERIAL PK&lt;br&gt;   sync_type      VARCHAR(50)&lt;br&gt;   status         VARCHAR(20)&lt;br&gt;   started_at     TIMESTAMP&lt;br&gt;   completed_at   TIMESTAMP&lt;br&gt;   items_processed INT&lt;br&gt;   error_message  TEXT&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="365" y="315" width="170" height="140" as="geometry" />
        </mxCell>

        <!-- ERRATA_CVE_OVAL_MAP TABLE (FIX #2) -->
        <mxCell id="tbl-oval-map" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=#9673A6;fillColor=#E1D5E7;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="360" y="490" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="tbl-oval-map-header" value="&lt;b&gt;errata_cve_oval_map&lt;/b&gt;&lt;br&gt;&lt;font style=&quot;font-size:9px&quot;&gt;[FIX #2] OVAL-CVE Mapping&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=#9673A6;fontColor=#FFFFFF;align=center;verticalAlign=middle;rounded=0;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="360" y="490" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="tbl-oval-map-cols" value="&lt;font style=&quot;font-size:10px;font-family:monospace&quot;&gt;&lt;b&gt;ðŸ”— errata_id&lt;/b&gt;  FK â†’ errata.id&lt;br&gt;&lt;b&gt;ðŸ”— cve_id&lt;/b&gt;     VARCHAR(20)&lt;br&gt;&lt;b&gt;ðŸ”— oval_id&lt;/b&gt;    FK â†’ oval.oval_id&lt;br&gt;&lt;br&gt;UNIQUE(errata_id, cve_id, oval_id)&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="365" y="525" width="170" height="80" as="geometry" />
        </mxCell>

        <!-- Relationship Arrows -->
        <!-- errata â†’ errata_cves -->
        <mxCell id="rel-errata-errata-cves" value="" style="endArrow=none;html=1;rounded=0;strokeWidth=2;strokeColor=#9673A6;startArrow=ERmany;startFill=0;endArrow=ERone;endFill=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="180" as="sourcePoint" />
            <mxPoint x="360" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-label-1" value="&lt;font style=&quot;font-size:8px&quot;&gt;1:N&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="330" y="160" width="30" height="15" as="geometry" />
        </mxCell>

        <!-- errata_cves â†’ cves -->
        <mxCell id="rel-errata-cves-cves" value="" style="endArrow=none;html=1;rounded=0;strokeWidth=2;strokeColor=#9673A6;startArrow=ERone;startFill=0;endArrow=ERmany;endFill=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="180" as="sourcePoint" />
            <mxPoint x="580" y="180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-label-2" value="&lt;font style=&quot;font-size:8px&quot;&gt;N:1&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="545" y="160" width="30" height="15" as="geometry" />
        </mxCell>

        <!-- cves â†’ cve_details -->
        <mxCell id="rel-cves-details" value="" style="endArrow=none;html=1;rounded=0;strokeWidth=2;strokeColor=#D79B00;startArrow=ERone;startFill=0;endArrow=ERoneToMany;endFill=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="690" y="230" as="sourcePoint" />
            <mxPoint x="690" y="260" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-label-3" value="&lt;font style=&quot;font-size:8px&quot;&gt;1:1&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="695" y="235" width="30" height="15" as="geometry" />
        </mxCell>

        <!-- errata â†’ errata_packages -->
        <mxCell id="rel-errata-pkg" value="" style="endArrow=none;html=1;rounded=0;strokeWidth=2;strokeColor=#0066CC;startArrow=ERone;startFill=0;endArrow=ERmany;endFill=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="180" y="380" as="sourcePoint" />
            <mxPoint x="180" y="410" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rel-label-4" value="&lt;font style=&quot;font-size:8px&quot;&gt;1:N&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="185" y="385" width="30" height="15" as="geometry" />
        </mxCell>

        <!-- errata â†’ errata_cve_oval_map -->
        <mxCell id="rel-errata-oval-map" value="" style="endArrow=none;html=1;rounded=0;strokeWidth=2;strokeColor=#9673A6;startArrow=ERone;startFill=0;endArrow=ERmany;endFill=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="340" as="sourcePoint" />
            <mxPoint x="360" y="540" as="targetPoint" />
            <Array as="points">
              <mxPoint x="340" y="340" />
              <mxPoint x="340" y="540" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- errata_cve_oval_map â†’ oval_definitions -->
        <mxCell id="rel-oval-map-oval" value="" style="endArrow=none;html=1;rounded=0;strokeWidth=2;strokeColor=#82B366;startArrow=ERmany;startFill=0;endArrow=ERone;endFill=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="550" as="sourcePoint" />
            <mxPoint x="900" y="300" as="targetPoint" />
            <Array as="points">
              <mxPoint x="600" y="550" />
              <mxPoint x="600" y="640" />
              <mxPoint x="870" y="640" />
              <mxPoint x="870" y="300" />
            </Array>
          </mxGeometry>
        </mxCell>

        <!-- Data Flow Description -->
        <mxCell id="flow-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#FAFAFA;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="40" y="640" width="540" height="140" as="geometry" />
        </mxCell>
        <mxCell id="flow-title" value="&lt;b&gt;Data Flow &amp; Relationships&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=12;" parent="1" vertex="1">
          <mxGeometry x="230" y="645" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="flow-desc" value="&lt;font style=&quot;font-size:10px&quot;&gt;&lt;b&gt;1. Sync USN/DSA:&lt;/b&gt; Creates &lt;b&gt;errata&lt;/b&gt; â†’ links to &lt;b&gt;cves&lt;/b&gt; via &lt;b&gt;errata_cves&lt;/b&gt; â†’ creates &lt;b&gt;errata_packages&lt;/b&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;2. Sync NVD:&lt;/b&gt; Enriches &lt;b&gt;cves&lt;/b&gt; with &lt;b&gt;cve_details&lt;/b&gt; (CVSS scores, CWE IDs, descriptions)&lt;br&gt;&lt;br&gt;&lt;b&gt;3. Sync OVAL:&lt;/b&gt; Creates &lt;b&gt;oval_definitions&lt;/b&gt; â†’ maps to errata via &lt;b&gt;errata_cve_oval_map&lt;/b&gt; [FIX #2]&lt;br&gt;&lt;br&gt;&lt;b&gt;4. UYUNI Push:&lt;/b&gt; Reads &lt;b&gt;errata&lt;/b&gt; (pending) + &lt;b&gt;errata_packages&lt;/b&gt; â†’ matches with &lt;b&gt;uyuni_package_cache&lt;/b&gt; [FIX #1]&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="50" y="670" width="520" height="105" as="geometry" />
        </mxCell>

        <!-- Statistics Box -->
        <mxCell id="stats-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#FAFAFA;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="600" y="640" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="stats-title" value="&lt;b&gt;Current Statistics (2026-01-31)&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="660" y="648" width="180" height="20" as="geometry" />
        </mxCell>
        <mxCell id="stats-content" value="&lt;font style=&quot;font-size:10px&quot;&gt;&lt;b&gt;errata:&lt;/b&gt; 116,261 (USN: 583, DSA: 115,678)&lt;br&gt;&lt;b&gt;cves:&lt;/b&gt; 47,845&lt;br&gt;&lt;b&gt;cve_details:&lt;/b&gt; 228+ (NVD enriched)&lt;br&gt;&lt;b&gt;errata_packages:&lt;/b&gt; ~200,000+&lt;br&gt;&lt;b&gt;oval_definitions:&lt;/b&gt; 50,862&lt;br&gt;&lt;b&gt;uyuni_package_cache:&lt;/b&gt; 140,937&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;spacingLeft=10;spacingTop=5;" parent="1" vertex="1">
          <mxGeometry x="610" y="670" width="260" height="105" as="geometry" />
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-bg" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=#666666;fillColor=#FAFAFA;strokeWidth=1;" parent="1" vertex="1">
          <mxGeometry x="900" y="640" width="280" height="140" as="geometry" />
        </mxCell>
        <mxCell id="legend-title" value="&lt;b&gt;Legend&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=11;" parent="1" vertex="1">
          <mxGeometry x="1000" y="648" width="80" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-errata" value="&lt;font style=&quot;font-size:9px&quot;&gt;Errata Core&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#DAE8FC;strokeColor=#0066CC;" parent="1" vertex="1">
          <mxGeometry x="910" y="675" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-cve" value="&lt;font style=&quot;font-size:9px&quot;&gt;CVE/OVAL&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#D5E8D4;strokeColor=#82B366;" parent="1" vertex="1">
          <mxGeometry x="985" y="675" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-nvd" value="&lt;font style=&quot;font-size:9px&quot;&gt;NVD Data&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFE6CC;strokeColor=#D79B00;" parent="1" vertex="1">
          <mxGeometry x="1060" y="675" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-join" value="&lt;font style=&quot;font-size:9px&quot;&gt;Join Tables&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#E1D5E7;strokeColor=#9673A6;" parent="1" vertex="1">
          <mxGeometry x="910" y="700" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-uyuni" value="&lt;font style=&quot;font-size:9px&quot;&gt;UYUNI Cache&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F8CECC;strokeColor=#B85450;" parent="1" vertex="1">
          <mxGeometry x="985" y="700" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-logs" value="&lt;font style=&quot;font-size:9px&quot;&gt;Audit Logs&lt;/font&gt;" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#F5F5F5;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="1060" y="700" width="70" height="20" as="geometry" />
        </mxCell>
        <mxCell id="leg-symbols" value="&lt;font style=&quot;font-size:9px&quot;&gt;&lt;b&gt;Symbols:&lt;/b&gt;&lt;br&gt;ðŸ”‘ = Primary Key&lt;br&gt;ðŸ”— = Foreign Key&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="910" y="730" width="220" height="45" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
